"use strict";(self.webpackChunkvisualization_collection=self.webpackChunkvisualization_collection||[]).push([[2697],{64484:(e,t,n)=>{n.r(t),n.d(t,{default:()=>H});var o=n(96540),r=n(6442),i=n(1372),a=n(39437),s=n(17024),c=n(83656),l=n(46935),u=n(9169),h=n(84963),d=n(85541),p=n(4457),m=n(74848);const f=10,g=10,w=e=>{const{title:t="",lineWidth:n=1,lineColor:i="#005A5A",highlightColor:a="#41B1B4",style:s={}}=e,c=(0,r.A)(),{menuWidth:u}=(0,l.S)(),h=(0,o.useRef)(null),w=(0,o.useRef)(null),b=(0,o.useRef)(null),v=(0,o.useRef)(!1),M=(0,o.useMemo)((()=>({fontSize:"18px",color:"#74CCD1",fontWeight:600,...s})),[s]),y=e=>{const t=b.current;if(w.current&&t){const{width:n,height:o}=w.current;let r=1;t.beginPath(),t.moveTo(r,8),r=8,t.lineTo(r,1),r+=40,t.lineTo(r,1),r+=8,t.lineTo(r,8),r=n-16,t.lineTo(r,8),r=n-e,t.lineTo(r,24),t.lineTo(r,o-e),r=16,t.lineTo(r,o-e),r=1,t.lineTo(r,o-16),t.closePath(),t.lineWidth=e}},P=()=>{if(w.current&&b.current){const{width:e,height:o}=w.current,r=b.current;r.clearRect(0,0,e,o),r.globalCompositeOperation="source-over";let s=n;if(v.current){s+=1,y(s),r.fillStyle=v.current?a:i,r.fill(),r.globalCompositeOperation="source-atop";let t=0,n=0;for(;n<=o&&t<=e;){const o=t+f,i=Math.floor(t/f),a=Math.floor(n/f);r.fillStyle=i%2==0&&a%2==0||i%2!=0&&a%2!=0?"#3D5454":"#445A5A",o>e?(r.fillRect(t,n,e-t,f),n+=f,t=0):(r.fillRect(t,n,f,f),t+=f)}}r.globalCompositeOperation="source-over",y(s);let c=1;if(r.strokeStyle=v.current?a:i,r.stroke(),r.lineWidth=s+1,r.strokeStyle=a,r.beginPath(),c=12,r.moveTo(c,8),c+=8,r.lineTo(c,8),r.closePath(),r.stroke(),r.beginPath(),c+=4,r.moveTo(c,8),c+=8,r.lineTo(c,8),r.closePath(),r.stroke(),r.beginPath(),c+=4,r.moveTo(c,8),c+=8,r.lineTo(c,8),r.closePath(),r.stroke(),r.beginPath(),c=e-s,r.moveTo(c,o-16),r.lineTo(c,o),r.closePath(),r.stroke(),r.beginPath(),r.moveTo(c,o-s),c-=16,r.lineTo(c,o-s),r.closePath(),r.stroke(),t){const n=(0,d.q_)(t,Number.parseInt(M.fontSize),M.fontWeight);r.font="".concat(M.fontWeight," ").concat(M.fontSize," SourceHanSansCN-Bold"),r.fillStyle=M.color,r.fillText(t,(e-n)/2,14+Number.parseInt(M.fontSize));let o=(e-n)/2-42;const a=14+Number.parseInt(M.fontSize)/2+2;r.lineWidth=4,r.lineJoin="miter",r.beginPath(),r.moveTo(o,18),r.lineTo(o+g,a),r.lineTo(o,14+Number.parseInt(M.fontSize)),r.strokeStyle=v.current?M.color:i,r.stroke(),r.beginPath(),r.moveTo(o+g+6,18),r.lineTo(o+20+6,a),r.lineTo(o+g+6,14+Number.parseInt(M.fontSize)),r.strokeStyle=M.color,r.stroke(),o=(e+n)/2+16,r.beginPath(),r.moveTo(o+g,18),r.lineTo(o,14+Number.parseInt(M.fontSize)/2+2),r.lineTo(o+g,14+Number.parseInt(M.fontSize)),r.strokeStyle=M.color,r.stroke(),r.beginPath(),r.moveTo(o+20+6,18),r.lineTo(o+g+6,14+Number.parseInt(M.fontSize)/2+2),r.lineTo(o+20+6,14+Number.parseInt(M.fontSize)),r.strokeStyle=v.current?M.color:i,r.stroke()}}};(0,o.useEffect)((()=>{if(h.current&&w.current){const{clientWidth:e,clientHeight:t}=h.current;w.current.width=e,w.current.height=t,b.current=w.current.getContext("2d"),P()}}),[t,u]);return(0,m.jsxs)("div",{className:p.A.container,style:M,onMouseEnter:()=>{v.current=!0,P()},onMouseLeave:()=>{v.current=!1,P()},ref:h,children:[(0,m.jsx)("canvas",{ref:w,children:c.formatMessage({id:"common.browserTooLow"})}),(0,m.jsx)("div",{className:p.A.content,style:{left:"".concat(16,"px"),right:"".concat(8,"px"),top:"".concat(t?8+Number.parseInt(M.fontSize)+6+20:14,"px"),bottom:"".concat(8,"px")},children:e.children})]})};var b=n(85880),v=n(97544);const M=()=>{const e=(0,o.useRef)(new a.B69),t=(0,o.useRef)(null),n=(0,o.useRef)(null);return(0,o.useEffect)((()=>{const o=((e,n,o)=>{const r=Math.PI/90,i=2*Math.PI-16*r,s=11*i/12/8,c=i/12/8,l=document.createElement("canvas");l.width=2*e,l.height=2*e;const u=l.getContext("2d");u.strokeStyle=o,u.lineWidth=n;let h=0,d=s;for(let t=0;t<8;t++)u.beginPath(),u.arc(e,e,e-n,h,d),u.stroke(),h=d+r,d=h+c,u.beginPath(),u.arc(e,e,e-n,h,d),u.stroke(),h=d+r,d=h+s;const p=new a.bdM(l.width,l.height),m=new a.V9B({map:new a.GOR(l),transparent:!0,opacity:1,depthWrite:!1}),f=new a.eaF(p,m),g={angle:0};return t.current=b.os.to(g,{angle:2*Math.PI,duration:5,ease:"linear",repeat:-1,onUpdate:()=>{const e=g.angle;if(f){const t=(new a.kn4).makeRotationZ(e),{x:n,y:o,z:r}=f.position;t.multiply((new a.kn4).makeTranslation(n,o,r)),f.matrix=t,f.matrix.decompose(f.position,f.quaternion,f.scale)}},onComplete:()=>{}}),f})(180,6,"#ffffff");e.current.add(o);const r=((e,t,n)=>{const o=document.createElement("canvas");o.width=2*e,o.height=2*e;const r=o.getContext("2d");r.strokeStyle=n,r.lineWidth=t;for(let n=0;n<2;n++){const o=n*Math.PI;r.beginPath(),r.arc(e,e,e-t,o,Math.PI/6+o),r.stroke(),r.beginPath(),r.arc(e,e,e-t,Math.PI/4+o,Math.PI/2+o),r.stroke(),r.beginPath(),r.arc(e,e,e-t,2*Math.PI/3+o,3*Math.PI/4+o),r.stroke()}const i=new a.bdM(o.width,o.height),s=new a.V9B({map:new a.GOR(o),transparent:!0,opacity:1,depthWrite:!1});return new a.eaF(i,s)})(170,8,"#005A5A");r.position.set(0,0,1),e.current.add(r);const i=((e,t,n)=>{const o=document.createElement("canvas");o.width=2*e,o.height=2*e;const r=o.getContext("2d");r.strokeStyle=n,r.lineWidth=t;for(let n=0;n<3;n++){const o=n*(2*Math.PI/3);r.beginPath(),r.arc(e,e,e-t,o,Math.PI/10+o),r.stroke(),r.beginPath(),r.arc(e,e,e-t,Math.PI/8+o,Math.PI/6+o),r.stroke(),r.beginPath(),r.arc(e,e,e-t,Math.PI/2+o,5*Math.PI/8+o),r.stroke()}const i=new a.bdM(o.width,o.height),s=new a.V9B({map:new a.GOR(o),transparent:!0,opacity:1,depthWrite:!1}),c=new a.eaF(i,s),l=new a.bdM(o.width+90,o.height+90),u=new a.V9B({map:(new a.Tap).load(v),transparent:!0,opacity:1,depthWrite:!1}),h=new a.eaF(l,u);return c.add(h),c})(120,8,"#005A5A");i.position.set(0,0,2),e.current.add(i);const s=((e,t,o)=>{const r=16,i=document.createElement("canvas");i.width=2*e+r,i.height=2*e+r;const s=i.getContext("2d");s.strokeStyle=o,s.lineWidth=t,s.beginPath(),s.arc(e+4.8+t,e+4.8+t,e,0,2*Math.PI),s.stroke(),s.lineWidth=t;for(let t=0;t<120;t++){const n=2*Math.PI/120*t,o=e-11.2,i=o+r,a=Math.cos(n)*i+i+4.8,c=Math.sin(n)*i+i+4.8,l=Math.cos(n)*o+i+4.8,u=Math.sin(n)*o+i+4.8;s.beginPath(),s.moveTo(a,c),s.lineTo(l,u),s.stroke()}const c=new a.bdM(i.width,i.height),l=new a.V9B({map:new a.GOR(i),transparent:!0,opacity:1,depthWrite:!1}),u=new a.eaF(c,l),h={angle:0};return n.current=b.os.to(h,{angle:2*-Math.PI,duration:12,ease:"linear",repeat:-1,onUpdate:()=>{const e=h.angle;if(u){const t=(new a.kn4).makeRotationZ(e),{x:n,y:o,z:r}=u.position;t.multiply((new a.kn4).makeTranslation(n,o,r)),u.matrix=t,u.matrix.decompose(u.position,u.quaternion,u.scale)}},onComplete:()=>{}}),u})(100,3,"#ADEBF1");s.position.set(0,0,3),e.current.add(s);const c=((e,t,n)=>{const o=document.createElement("canvas");o.width=2*e,o.height=2*e;const r=o.getContext("2d");r.strokeStyle=n,r.lineWidth=t,r.beginPath(),r.arc(e,e,e-t,0,2*Math.PI),r.stroke();const i=new a.bdM(o.width,o.height),s=new a.V9B({map:new a.GOR(o),transparent:!0,opacity:1,depthWrite:!1});return new a.eaF(i,s)})(80,1,"#ADEBF1");c.position.set(0,0,4),e.current.add(c);const l=((e,t,n)=>{const o=document.createElement("canvas");o.width=2*e,o.height=2*e;const r=o.getContext("2d");r.strokeStyle=n,r.lineWidth=t,r.beginPath(),r.arc(e,e,e-t,0,2*Math.PI),r.stroke();const i=new a.bdM(o.width,o.height),s=new a.V9B({map:new a.GOR(o),transparent:!0,opacity:1,depthWrite:!1});return new a.eaF(i,s)})(30,4,"#ADEBF1");return l.position.set(0,0,5),e.current.add(l),()=>{var e,o;null===(e=t.current)||void 0===e||e.kill(),null===(o=n.current)||void 0===o||o.kill()}}),[]),e.current};var y=n(39830),P=n(54935),k=n(7759),x=n(90774);const T="MapDisplay_container__JzMWi",_="MapDisplay_switch__nUbu8",S="MapDisplay_topBox__-iLmj",j="MapDisplay_topBg__c6rCu",C="MapDisplay_shine__ySyEV",N="MapDisplay_leftLine__pZTNS",I="MapDisplay_rightLine__RbfEL",R="MapDisplay_title__A3fT8",A="MapDisplay_leftBox__vVd6G",W="MapDisplay_item__ePBfW",B="MapDisplay_rightBox__NC-0G",z="MapDisplay_tooltip__+Ashp",E=0,D=-20,F=80,O=0,V=6,L=0,G="#008170",Y="#1AACAC",q="#005B41",H=()=>{const e=(0,r.A)(),{menuWidth:t,headHeight:n}=(0,l.S)(),d=(0,o.useRef)(null),p=(0,o.useRef)(null),f=(0,o.useRef)(null),g=(0,o.useRef)(null),b=(0,o.useRef)(null),v=(0,o.useRef)(null),H=(0,o.useRef)(null),J=(0,o.useRef)(null),U=(0,o.useRef)(new a.tBo),Z=(0,o.useRef)(null),Q=(0,o.useRef)(null),[X,K]=(0,o.useState)(!0),{restart:$,reverse:ee}=(0,h.A)(p,"toBottom",.6),{restart:te,reverse:ne}=(0,h.A)(f,"toRight",.8,.5),{restart:oe,reverse:re}=(0,h.A)(g,"toLeft",.8,.5),ie=M(),ae=e=>{(new a.Y9S).load("./public/json/ChinaMap.json",(t=>{((e,t)=>{const n=new a.B69,o=(0,c.Ay)().center([104,37.5]).scale(80).translate([0,0]);e.features.forEach((e=>{const t=new a.B69,{coordinates:r}=e.geometry;r.forEach((n=>{n.forEach((n=>{const r=new a.ypk,i=new a.LoY,s=[];for(let e=0;e<n.length;e++){const[t,i]=o(n[e]);0===e?r.moveTo(t,-i):r.lineTo(t,-i),s.push(new a.Pq0(t,-i,6))}i.setFromPoints(s);const c={depth:6,bevelEnabled:!1,bevelThickness:1,bevelSize:1,bevelOffset:0,bevelSegments:1},l=new a.QCA(r,c),u=new a.V9B({color:G,transparent:!0,opacity:.95}),h=new a.V9B({color:Y,transparent:!0,opacity:.95}),d=new a.eaF(l,[u,h]),p=new a.mrM({color:"white"}),m=new a.N1A(i,p);t.properties=e.properties,t.add(d),t.add(m)}))})),n.add(t)})),n.position.set(O,V,L),t.add(n),H.current=n})(JSON.parse(t),e),ie.scale.set(.32,.32,1),ie.position.set(0,0,-8),e.add(ie),J.current=ie}))},se=(0,o.useCallback)((e=>{if(b.current){Z.current||(Z.current=new a.I9Y);const{clientX:o,clientY:r}=e;new a.I9Y&&(Z.current.x=(o-t)/(window.innerWidth-t)*2-1),Z.current.y=-(r-n)/(window.innerHeight-n)*2+1,b.current.style.left="".concat(o-t+4,"px"),b.current.style.top="".concat(r-n+4,"px")}}),[t,n]),{scene:ce,resize:le}=(0,u.A)(d,((e,t,n)=>{if(d.current){e.background=(new a.Tap).load(P),t.position.set(E,D,F);const o=new s.N(t,n.domElement);v.current=o,o.enableDamping=!0,o.dampingFactor=.05,ae(e)}}),null,((e,t)=>{if(H.current&&Z.current){var n;Q.current&&(Q.current.object.material[0].color.set(G),Q.current.object.material[1].color.set(Y),b.current&&(b.current.style.visibility="hidden")),Q.current=null,U.current.setFromCamera(Z.current,t);const o=U.current.intersectObjects(e.children,!0);Q.current=o.find((e=>e.object.material&&2===e.object.material.length)),Q.current&&null!==(n=Q.current.object)&&void 0!==n&&null!==(n=n.parent)&&void 0!==n&&null!==(n=n.properties)&&void 0!==n&&n.name&&(Q.current.object.material[0].color.set(q),Q.current.object.material[1].color.set(q),(()=>{if(b.current)if(Q.current){const{properties:e}=Q.current.object.parent;b.current.textContent=e.name,b.current.style.visibility="visible"}else b.current.style.visibility="hidden"})())}var o;v.current&&(null===(o=v.current)||void 0===o||o.update())}));return(0,o.useLayoutEffect)((()=>{le()}),[t]),(0,o.useEffect)((()=>()=>{(0,y.AP)(H.current,ce),(0,y.AP)(J.current,ce)}),[]),(0,m.jsxs)("div",{className:T,onMouseMove:se,ref:d,children:[(0,m.jsx)("div",{className:_,onClick:()=>{X?(ee(),ne(),re()):($(),te(),oe()),K(!X)},children:(0,m.jsx)(i.A,{})}),(0,m.jsxs)("div",{className:S,ref:p,children:[(0,m.jsx)("img",{src:k,alt:"",className:j}),(0,m.jsx)("img",{src:x,alt:"",className:C}),(0,m.jsx)("div",{className:N}),(0,m.jsx)("div",{className:I}),(0,m.jsx)("div",{className:R,children:(0,m.jsx)("span",{children:e.formatMessage({id:"page.threeJs3D.visualizationPlatform"})})})]}),(0,m.jsxs)("div",{className:A,ref:f,children:[(0,m.jsx)("div",{className:W,children:(0,m.jsx)(w,{title:e.formatMessage({id:"common.moduleTitle"}),children:e.formatMessage({id:"common.customizeContent"})})}),(0,m.jsx)("div",{className:W,children:(0,m.jsx)(w,{children:e.formatMessage({id:"common.customizeContent"})})})]}),(0,m.jsxs)("div",{className:B,ref:g,children:[(0,m.jsx)("div",{className:W,children:(0,m.jsx)(w,{title:e.formatMessage({id:"common.moduleTitle"}),children:e.formatMessage({id:"common.customizeContent"})})}),(0,m.jsx)("div",{className:W,children:(0,m.jsx)(w,{children:e.formatMessage({id:"common.customizeContent"})})})]}),(0,m.jsx)("div",{className:z,ref:b})]})}}}]);